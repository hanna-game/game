<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® TV-Spels M√•larbok: F√§rg efter Nummer</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive; /* TV-spelsfont */
            text-align: center;
            background-color: #222; /* M√∂rk bakgrund */
            color: #eee; /* Ljus text */
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            line-height: 1.5; /* F√∂rb√§ttra l√§sbarhet f√∂r pixel-font */
        }

        h1 {
            color: #4CAF50; /* Gr√∂n f√∂r TV-spel */
            text-shadow: 2px 2px 0 #000, 4px 4px 0 #1a1a1a; /* Pixel-skugga */
            margin-bottom: 25px;
            font-size: 1.8em; /* Anpassa storlek f√∂r pixel-font */
        }
        h2 {
            color: #FFEB3B; /* Gul f√∂r niv√•-indikator */
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        /* F√§rgpaletten */
        #color-palette {
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* L√•t rutorna bryta rad om det beh√∂vs */
            gap: 10px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #333;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            border: 2px solid #555;
        }

        .color-option {
            width: 50px; /* Mindre knappar */
            height: 50px;
            border-radius: 8px; /* Fyrkantiga med rundade h√∂rn */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 3px solid transparent;
            transition: border-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            font-weight: bold;
            font-size: 1.2em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .color-option:hover {
            transform: scale(1.08);
        }

        .color-option.active {
            border-color: #00BCD4; /* Turkos/cyan kant f√∂r aktiv f√§rg */
            transform: scale(1.1);
        }

        /* M√•laromr√•det (rutn√§tet) */
        #drawing-area {
            display: grid;
            border: 5px solid #444; /* Tjockare kant */
            background-color: #111; /* M√∂rkare bakgrund i rutan */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
            /* grid-template-columns kommer att s√§ttas av JavaScript */
        }

        .cell {
            width: 25px; /* Mindre standardstorlek p√• varje ruta f√∂r mer detaljer */
            height: 25px;
            border: 1px solid #333; /* M√∂rkare tunna linjer */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8em;
            font-weight: bold;
            color: #888; /* F√§rg p√• siffran i rutan */
            cursor: pointer;
            transition: background-color 0.05s linear; /* Snabbare transition */
        }

        .cell.colored {
            color: transparent; /* D√∂lj siffran n√§r rutan √§r f√§rgad */
        }

        /* Niv√•-kontroller och meddelanden */
        #controls {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        #controls button {
            background-color: #00796B; /* M√∂rk turkos */
            color: white;
            border: 2px solid #004D40;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9em;
            border-radius: 5px;
            cursor: pointer;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
            transition: background-color 0.2s ease, transform 0.2s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }
        #controls button:hover {
            background-color: #009688; /* Ljusare turkos */
            transform: translateY(-2px);
        }
        #controls button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        #level-completion-message {
            margin-top: 25px;
            font-size: 1.5em;
            color: #FFC107; /* Orange f√∂r seger */
            text-shadow: 2px 2px 0 #000;
        }

    </style>
</head>
<body>

    <h1>üé® TV-Spels M√•larbok: F√§rg efter Nummer</h1>
    <h2 id="level-indicator">Niv√• 1</h2>

    <div id="color-palette">
        </div>

    <div id="drawing-area">
        </div>

    <div id="controls">
        <button id="prev-level-btn" disabled>‚Üê F√∂reg√•ende niv√•</button>
        <button id="next-level-btn">N√§sta niv√• ‚Üí</button>
    </div>

    <p id="level-completion-message"></p>

    <script>
        // 1. Definition av f√§rger f√∂r TV-spelstema
        const gameColors = {
            1: '#FF0000', // R√∂d (Mario, eld)
            2: '#0000FF', // Bl√• (vatten, bl√•a block)
            3: '#00FF00', // Gr√∂n (svamp, gr√§s)
            4: '#FFFF00', // Gul (mynt, stj√§rna)
            5: '#FFA500', // Orange (block, eld)
            6: '#A52A2A', // Brun (jord, tr√§)
            7: '#800080', // Lila (ghosts, power-ups)
            8: '#008080', // Turkost (vatten, special)
            9: '#FFFFFF', // Vit (moln, √∂gon)
            10: '#000000' // Svart (konturer, tomrum)
        };

        // 2. Definition av niv√•er med TV-spelsm√∂nster
        const levels = [
            // Niv√• 1: Enkel Mario-svamp (10x10)
            {
                name: "Mario Svamp (L√§tt)",
                colors: {
                    1: '#FF0000', // R√∂d
                    2: '#FFFFFF', // Vit
                    3: '#A52A2A', // Brun
                    10: '#000000' // Svart kontur
                },
                pattern: [
                    [10,10,10,10,10,10,10,10,10,10],
                    [10,0,0,10,1,1,10,0,0,10],
                    [10,0,10,1,1,1,1,10,0,10],
                    [10,10,1,1,1,1,1,1,10,10],
                    [10,1,1,1,1,1,1,1,1,10],
                    [10,1,1,2,2,2,2,1,1,10],
                    [10,1,2,2,2,2,2,2,1,10],
                    [10,0,10,3,3,3,3,10,0,10],
                    [10,0,0,10,3,3,10,0,0,10],
                    [10,10,10,10,10,10,10,10,10,10]
                ],
                rows: 10,
                cols: 10,
                cellSize: 30
            },
            // Niv√• 2: Pac-Man (15x15)
            {
                name: "Pac-Man (Mellan)",
                colors: {
                    1: '#FFFF00', // Gul
                    2: '#000000', // Svart (bakgrund/√∂ga)
                    3: '#FFFFFF' // Vit (√∂ga)
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,1,1,1,1,1,1,0,0,0,0],
                    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0],
                    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0],
                    [0,0,1,1,1,1,1,1,1,1,1,1,1,1,0],
                    [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,0], /* Denna rad √§r "munnen" */
                    [1,1,1,1,1,1,1,1,1,1,1,1,0,0,0],
                    [0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
                    [0,0,1,1,1,1,1,1,1,1,1,1,1,1,0],
                    [0,0,0,1,1,1,1,1,1,1,1,1,1,0,0],
                    [0,0,0,0,1,1,1,1,1,1,1,1,0,0,0],
                    [0,0,0,0,0,1,1,1,1,1,1,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                ],
                rows: 15,
                cols: 15,
                cellSize: 25
            },
             // Niv√• 3: Enkel Tetris-bit (12x12)
             {
                name: "Tetris T-bit (Normal)",
                colors: {
                    1: '#800080', // Lila (Tetris T-bit f√§rg)
                    10: '#000000' // Svart kontur
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,10,1,1,10,0,0,0,0],
                    [0,0,0,10,1,1,1,1,10,0,0,0],
                    [0,0,0,10,1,1,1,1,10,0,0,0],
                    [0,0,0,0,10,1,10,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0]
                ],
                rows: 12,
                cols: 12,
                cellSize: 30
            }
            // L√§gg till fler niv√•er h√§r
            /*
            , {
                name: "Niv√• 4: Mer komplex bild",
                colors: { ... },
                pattern: [
                    [...],
                    [...]
                ],
                rows: X,
                cols: Y,
                cellSize: Z
            }
            */
        ];

        let currentLevelIndex = 0;
        let activeColorNumber = null;

        const colorPaletteEl = document.getElementById('color-palette');
        const drawingAreaEl = document.getElementById('drawing-area');
        const levelIndicatorEl = document.getElementById('level-indicator');
        const prevLevelBtn = document.getElementById('prev-level-btn');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const levelCompletionMessageEl = document.getElementById('level-completion-message');

        // Funktion f√∂r att skapa f√§rgpaletten f√∂r den aktuella niv√•n
        function createColorPalette(levelColors) {
            colorPaletteEl.innerHTML = ''; // Rensa paletten f√∂rst
            for (const num in levelColors) {
                const colorOption = document.createElement('div');
                colorOption.classList.add('color-option');
                colorOption.style.backgroundColor = levelColors[num];
                colorOption.textContent = num;
                colorOption.dataset.colorNumber = num;

                colorOption.addEventListener('click', () => {
                    const currentActive = document.querySelector('.color-option.active');
                    if (currentActive) {
                        currentActive.classList.remove('active');
                    }
                    colorOption.classList.add('active');
                    activeColorNumber = parseInt(num);
                });
                colorPaletteEl.appendChild(colorOption);
            }
            // V√§lj f√∂rsta f√§rgen som standard om det finns f√§rger
            if (colorPaletteEl.children.length > 0) {
                colorPaletteEl.children[0].click();
            } else {
                activeColorNumber = null; // Ingen f√§rg vald
            }
        }

        // Funktion f√∂r att skapa m√•laromr√•det f√∂r den aktuella niv√•n
        function createDrawingArea(pattern, rows, cols, cellSize) {
            drawingAreaEl.innerHTML = ''; // Rensa m√•laromr√•det f√∂rst
            drawingAreaEl.style.gridTemplateColumns = `repeat(${cols}, ${cellSize}px)`;
            // Justera bredden f√∂r att ta h√§nsyn till border
            drawingAreaEl.style.width = `${cols * cellSize + (cols * 2)}px`; // +2px per kolumn f√∂r 1px border p√• varje sida

            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    cell.dataset.expectedColor = pattern[r][c];
                    cell.style.width = `${cellSize}px`; // S√§tt storlek dynamiskt
                    cell.style.height = `${cellSize}px`; // S√§tt storlek dynamiskt

                    if (pattern[r][c] !== 0) {
                        cell.textContent = pattern[r][c];
                    }

                    cell.addEventListener('click', () => {
                        if (cell.classList.contains('colored')) {
                            return;
                        }

                        if (activeColorNumber === parseInt(cell.dataset.expectedColor)) {
                            cell.style.backgroundColor = levels[currentLevelIndex].colors[activeColorNumber];
                            cell.classList.add('colored');
                            cell.textContent = '';
                            checkLevelCompletion(); // Kontrollera om niv√•n √§r klar
                        } else if (activeColorNumber !== null) {
                            // Fel f√§rg feedback
                            cell.style.transition = 'none';
                            cell.style.backgroundColor = '#FF4500'; // R√∂d-orange som felindikation
                            setTimeout(() => {
                                cell.style.backgroundColor = '';
                                cell.style.transition = 'background-color 0.05s linear';
                            }, 150);
                        }
                    });
                    drawingAreaEl.appendChild(cell);
                }
            }
        }

        // Funktion f√∂r att ladda en specifik niv√•
        function loadLevel(index) {
            if (index >= 0 && index < levels.length) {
                currentLevelIndex = index;
                const level = levels[currentLevelIndex];
                
                levelIndicatorEl.textContent = `Niv√• ${currentLevelIndex + 1}: ${level.name}`;
                levelCompletionMessageEl.textContent = ""; // Rensa meddelande

                createColorPalette(level.colors);
                createDrawingArea(level.pattern, level.rows, level.cols, level.cellSize);
                updateControlButtons();
            }
        }

        // Kontrollera om niv√•n √§r klar
        function checkLevelCompletion() {
            const cells = document.querySelectorAll('#drawing-area .cell');
            let allColored = true;
            for (const cell of cells) {
                // Bara rutor som har ett f√∂rv√§ntat f√§rgv√§rde (inte 0) m√•ste f√§rgas
                if (parseInt(cell.dataset.expectedColor) !== 0 && !cell.classList.contains('colored')) {
                    allColored = false;
                    break;
                }
            }

            if (allColored) {
                levelCompletionMessageEl.textContent = `üéâ Grattis! Niv√• ${currentLevelIndex + 1} klar!`;
                // Du kan l√§gga till en animation eller specialeffekt h√§r
                // Om sista niv√•n √§r klar
                if (currentLevelIndex === levels.length - 1) {
                    levelCompletionMessageEl.textContent = `ü•≥ GRATTIS! Du har klarat alla niv√•er!`;
                    nextLevelBtn.disabled = true; // Ingen mer att g√• till
                }
            }
        }

        // Uppdatera knapparnas status (aktivera/inaktivera)
        function updateControlButtons() {
            prevLevelBtn.disabled = (currentLevelIndex === 0);
            nextLevelBtn.disabled = (currentLevelIndex === levels.length - 1);
        }

        // Eventlyssnare f√∂r niv√•navigering
        prevLevelBtn.addEventListener('click', () => {
            if (currentLevelIndex > 0) {
                loadLevel(currentLevelIndex - 1);
            }
        });

        nextLevelBtn.addEventListener('click', () => {
            if (currentLevelIndex < levels.length - 1) {
                loadLevel(currentLevelIndex + 1);
            }
        });

        // Starta med den f√∂rsta niv√•n
        loadLevel(0);
    </script>
</body>
</html>
