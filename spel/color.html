<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® TV-Spels M√•larbok: F√§rg efter Nummer</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive; /* TV-spelsfont */
            text-align: center;
            background-color: #222; /* M√∂rk bakgrund */
            color: #eee; /* Ljus text */
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            line-height: 1.5; /* F√∂rb√§ttra l√§sbarhet f√∂r pixel-font */
        }

        h1 {
            color: #4CAF50; /* Gr√∂n f√∂r TV-spel */
            text-shadow: 2px 2px 0 #000, 4px 4px 0 #1a1a1a; /* Pixel-skugga */
            margin-bottom: 25px;
            font-size: 1.8em; /* Anpassa storlek f√∂r pixel-font */
        }
        h2 {
            color: #FFEB3B; /* Gul f√∂r niv√•-indikator */
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        /* F√§rgpaletten */
        #color-palette {
            display: flex;
            justify-content: center;
            flex-wrap: wrap; /* L√•t rutorna bryta rad om det beh√∂vs */
            gap: 10px;
            margin-bottom: 30px;
            padding: 15px;
            background-color: #333;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            border: 2px solid #555;
        }

        .color-option {
            width: 50px; /* Mindre knappar */
            height: 50px;
            border-radius: 8px; /* Fyrkantiga med rundade h√∂rn */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 3px solid transparent;
            transition: border-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            font-weight: bold;
            font-size: 1.2em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .color-option:hover {
            transform: scale(1.08);
        }

        .color-option.active {
            border-color: #00BCD4; /* Turkos/cyan kant f√∂r aktiv f√§rg */
            transform: scale(1.1);
        }

        /* M√•laromr√•det (rutn√§tet) */
        #drawing-area {
            display: grid;
            border: 5px solid #444; /* Tjockare kant */
            background-color: #111; /* M√∂rkare bakgrund i rutan */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
            border-radius: 8px;
            overflow: hidden;
            margin-top: 20px;
            /* grid-template-columns kommer att s√§ttas av JavaScript */
        }

        .cell {
            width: 25px; /* Standardstorlek p√• varje ruta */
            height: 25px;
            border: 1px solid #333; /* M√∂rkare tunna linjer */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8em;
            font-weight: bold;
            color: #888; /* F√§rg p√• siffran i rutan */
            cursor: pointer;
            transition: background-color 0.05s linear; /* Snabbare transition */
        }

        .cell.colored {
            color: transparent; /* D√∂lj siffran n√§r rutan √§r f√§rgad */
        }

        /* Niv√•-kontroller och meddelanden */
        #controls {
            margin-top: 30px;
            display: flex;
            gap: 15px;
        }
        #controls button {
            background-color: #00796B; /* M√∂rk turkos */
            color: white;
            border: 2px solid #004D40;
            padding: 10px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9em;
            border-radius: 5px;
            cursor: pointer;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
            transition: background-color 0.2s ease, transform 0.2s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }
        #controls button:hover {
            background-color: #009688; /* Ljusare turkos */
            transform: translateY(-2px);
        }
        #controls button:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }

        #level-completion-message {
            margin-top: 25px;
            font-size: 1.5em;
            color: #FFC107; /* Orange f√∂r seger */
            text-shadow: 2px 2px 0 #000;
        }

    </style>
</head>
<body>

    <h1>üé® TV-Spels M√•larbok: F√§rg efter Nummer</h1>
    <h2 id="level-indicator">Niv√• 1</h2>

    <div id="color-palette">
        </div>

    <div id="drawing-area">
        </div>

    <div id="controls">
        <button id="prev-level-btn" disabled>‚Üê F√∂reg√•ende niv√•</button>
        <button id="next-level-btn">N√§sta niv√• ‚Üí</button>
    </div>

    <p id="level-completion-message"></p>

    <script>
        // 1. Definition av gemensamma f√§rger (kan variera per niv√• om s√• √∂nskas)
        const commonColors = {
            1: '#FF0000', // R√∂d
            2: '#0000FF', // Bl√•
            3: '#00FF00', // Gr√∂n
            4: '#FFFF00', // Gul
            5: '#FFA500', // Orange
            6: '#A52A2A', // Brun
            7: '#800080', // Lila
            8: '#008080', // Turkost
            9: '#FFFFFF', // Vit
            10: '#000000' // Svart
        };

        // 2. Definition av niv√•er med TV-spelsm√∂nster
        const levels = [
            // Niv√• 1: Klassisk Mario Svamp (12x12)
            {
                name: "Svamp", // Dold i UI, bara f√∂r intern referens
                colors: { // Specifik palett f√∂r denna niv√•
                    1: commonColors[1],  // R√∂d
                    2: commonColors[9],  // Vit
                    3: commonColors[6],  // Brun
                    10: commonColors[10] // Svart
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,10,1,1,10,0,0,0,0],
                    [0,0,0,10,1,1,1,1,10,0,0,0],
                    [0,0,10,1,1,1,1,1,1,10,0,0],
                    [0,10,1,1,1,1,1,1,1,1,10,0],
                    [10,1,1,2,2,2,2,1,1,10,0,0],
                    [10,1,2,2,2,2,2,2,1,1,10,0],
                    [10,0,10,3,3,3,3,10,0,0,0,0],
                    [0,0,0,10,3,3,10,0,0,0,0,0],
                    [0,0,0,10,3,3,10,0,0,0,0,0], // Extra rad f√∂r stammen
                    [0,0,0,0,10,10,10,0,0,0,0,0], // Botten p√• stammen
                    [0,0,0,0,0,0,0,0,0,0,0,0]
                ],
                rows: 12,
                cols: 12,
                cellSize: 28 // Lite mindre f√∂r mer detalj
            },
            // Niv√• 2: Pac-Man med sp√∂kfiende (15x15)
            {
                name: "Pac-Man & Ghost",
                colors: {
                    1: commonColors[4],  // Gul (Pac-Man)
                    2: commonColors[10], // Svart (kontur/√∂ga/bakgrund)
                    3: commonColors[9],  // Vit (√∂ga)
                    4: commonColors[1],  // R√∂d (Sp√∂ke)
                    5: commonColors[8]   // Turkost (Sp√∂kets √∂gon)
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,2,2,2,2,2,2,0,0,0,0],
                    [0,0,0,0,2,1,1,1,1,1,1,2,0,0,0],
                    [0,0,0,2,1,1,1,1,1,1,1,1,2,0,0],
                    [0,0,2,1,1,1,1,1,1,1,1,1,1,2,0],
                    [0,2,1,1,1,1,1,1,1,1,1,1,1,1,2],
                    [2,1,1,1,1,1,1,1,1,1,1,1,1,1,0], // Pac-Man mun
                    [2,1,1,1,1,1,1,1,1,1,1,2,0,0,0],
                    [0,2,1,1,1,1,1,1,1,1,1,1,1,1,2],
                    [0,0,2,1,1,1,1,1,1,1,1,1,1,2,0],
                    [0,0,0,2,1,1,1,1,1,1,1,1,2,0,0],
                    [0,0,0,0,2,1,1,1,1,1,1,2,0,0,0],
                    [0,0,0,0,0,2,2,2,2,2,2,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    // En liten r√∂d sp√∂kfiende
                    [0,0,0,0,0,0,0,0,0,0,0,2,4,4,2],
                    [0,0,0,0,0,0,0,0,0,0,2,4,4,4,4],
                    [0,0,0,0,0,0,0,0,0,2,4,4,4,4,2],
                    [0,0,0,0,0,0,0,0,2,4,4,4,4,2,0],
                    [0,0,0,0,0,0,0,0,2,4,5,5,4,2,0], /* Sp√∂kets √∂gon */
                    [0,0,0,0,0,0,0,0,2,4,4,4,4,2,0],
                    [0,0,0,0,0,0,0,0,2,2,2,2,2,2,0] // Botten p√• sp√∂ket
                ],
                rows: 22, // √ñka antalet rader f√∂r att f√• plats med sp√∂ket
                cols: 15,
                cellSize: 20 // Mindre celler f√∂r st√∂rre bild
            },
             // Niv√• 3: Olika Tetris-bitar (15x15)
             {
                name: "Tetris Pussel",
                colors: {
                    1: commonColors[1],  // R√∂d
                    2: commonColors[4],  // Gul
                    3: commonColors[3],  // Gr√∂n
                    4: commonColors[2],  // Bl√•
                    5: commonColors[7],  // Lila (T-bit)
                    6: commonColors[8],  // Turkost
                    10: commonColors[10] // Svart (konturer)
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,10,10,1,1,10,0,0,0,0,0,0,0,0], // R√∂d L-bit
                    [0,0,0,10,1,10,0,0,0,0,0,0,0,0,0],
                    [0,0,0,10,1,10,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,10,5,10,0,0,0,0,0], // Lila T-bit
                    [0,0,0,0,0,10,5,5,5,10,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,10,3,10,0,0,0], // Gr√∂n S-bit
                    [0,0,0,0,0,0,0,10,3,3,10,0,0,0,0],
                    [0,0,0,0,0,10,3,3,10,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,10,2,2,10,0,0,0,0,0,0,0,0,0], // Bl√• kvadrat
                    [0,0,10,2,2,10,0,0,0,0,0,0,0,0,0]
                ],
                rows: 15,
                cols: 15,
                cellSize: 25
            },
             // Niv√• 4: Klassisk Pok√©boll (20x20) - Mer avancerad
             {
                name: "Pok√©boll",
                colors: {
                    1: commonColors[1],  // R√∂d
                    2: commonColors[9],  // Vit
                    3: commonColors[10]  // Svart
                },
                pattern: [
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,10,10,10,10,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,10,1,1,1,1,1,1,10,0,0,0,0,0,0,0],
                    [0,0,0,0,10,1,1,1,1,1,1,1,1,10,0,0,0,0,0,0],
                    [0,0,0,10,1,1,1,1,1,1,1,1,1,1,10,0,0,0,0,0],
                    [0,0,10,1,1,1,1,1,1,1,1,1,1,1,1,10,0,0,0,0],
                    [0,10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,0,0,0],
                    [10,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,0,0],
                    [10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,0,0], /* Mittlinjen */
                    [0,0,0,0,0,0,0,0,10,2,2,10,0,0,0,0,0,0,0,0], /* Knapp */
                    [0,0,0,0,0,0,0,10,2,2,2,2,10,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,10,2,2,2,2,2,2,10,0,0,0,0,0,0],
                    [0,0,0,0,0,10,2,2,2,2,2,2,2,2,10,0,0,0,0,0],
                    [0,0,0,0,10,2,2,2,2,2,2,2,2,2,2,10,0,0,0,0],
                    [0,0,0,10,2,2,2,2,2,2,2,2,2,2,2,2,10,0,0,0],
                    [0,0,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,0,0],
                    [0,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,0],
                    [0,0,10,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,0,0],
                    [0,0,0,10,2,2,2,2,2,2,2,2,2,2,2,2,10,0,0,0],
                    [0,0,0,0,10,2,2,2,2,2,2,2,2,2,2,10,0,0,0,0],
                    [0,0,0,0,0,10,2,2,2,2,2,2,2,2,10,0,0,0,0,0],
                    [0,0,0,0,0,0,10,2,2,2,2,2,10,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,10,2,2,10,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,10,10,0,0,0,0,0,0,0,0,0,0],
                    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
                ],
                rows: 28, // Mycket st√∂rre
                cols: 20,
                cellSize: 15 // V√§ldigt sm√• celler
            }
            // L√§gg till fler niv√•er h√§r f√∂r totalt 5
            /*
            , {
                name: "Niv√• 5: Sista utmaningen",
                colors: { ... },
                pattern: [
                    [...],
                    [...]
                ],
                rows: X,
                cols: Y,
                cellSize: Z
            }
            */
        ];

        let currentLevelIndex = 0;
        let activeColorNumber = null;

        const colorPaletteEl = document.getElementById('color-palette');
        const drawingAreaEl = document.getElementById('drawing-area');
        const levelIndicatorEl = document.getElementById('level-indicator');
        const prevLevelBtn = document.getElementById('prev-level-btn');
        const nextLevelBtn = document.getElementById('next-level-btn');
        const levelCompletionMessageEl = document.getElementById('level-completion-message');

        // Funktion f√∂r att skapa f√§rgpaletten f√∂r den aktuella niv√•n
        function createColorPalette(levelColors) {
            colorPaletteEl.innerHTML = ''; // Rensa paletten f√∂rst
            for (const num in levelColors) {
                const colorOption = document.createElement('div');
                colorOption.classList.add('color-option');
                colorOption.style.backgroundColor = levelColors[num];
                colorOption.textContent = num;
                colorOption.dataset.colorNumber = num;

                colorOption.addEventListener('click', () => {
                    const currentActive = document.querySelector('.color-option.active');
                    if (currentActive) {
                        currentActive.classList.remove('active');
                    }
                    colorOption.classList.add('active');
                    activeColorNumber = parseInt(num);
                });
                colorPaletteEl.appendChild(colorOption);
            }
            // V√§lj f√∂rsta f√§rgen som standard om det finns f√§rger
            if (colorPaletteEl.children.length > 0) {
                colorPaletteEl.children[0].click();
            } else {
                activeColorNumber = null; // Ingen f√§rg vald
            }
        }

        // Funktion f√∂r att skapa m√•laromr√•det (rutn√§tet)
        function createDrawingArea(pattern, rows, cols, cellSize) {
            drawingAreaEl.innerHTML = ''; // Rensa m√•laromr√•det f√∂rst
            drawingAreaEl.style.gridTemplateColumns = `repeat(${cols}, ${cellSize}px)`;
            // Justera bredden f√∂r att ta h√§nsyn till border. 2px per kolumn (1px p√• varje sida)
            drawingAreaEl.style.width = `${cols * cellSize + (cols * 2)}px`; 
            drawingAreaEl.style.height = `${rows * cellSize + (rows * 2)}px`; 

            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    cell.dataset.expectedColor = pattern[r][c];
                    cell.style.width = `${cellSize}px`; // S√§tt storlek dynamiskt
                    cell.style.height = `${cellSize}px`; // S√§tt storlek dynamiskt

                    if (pattern[r][c] !== 0) { // Visa numret om det inte √§r en "tom" ruta (0)
                        cell.textContent = pattern[r][c];
                    }

                    cell.addEventListener('click', () => {
                        // Kontrollera om rutan redan √§r f√§rgad och om den ska vara f√§rgad (inte 0)
                        if (parseInt(cell.dataset.expectedColor) === 0 || cell.classList.contains('colored')) {
                            return; // G√∂r inget om den ska vara tom eller redan √§r f√§rgad
                        }

                        // Om den aktiva f√§rgen matchar det f√∂rv√§ntade numret f√∂r rutan
                        if (activeColorNumber === parseInt(cell.dataset.expectedColor)) {
                            // Anv√§nd f√§rgen fr√•n den aktuella niv√•ns palett
                            cell.style.backgroundColor = levels[currentLevelIndex].colors[activeColorNumber];
                            cell.classList.add('colored'); // Markera som f√§rgad
                            cell.textContent = ''; // Ta bort siffran
                            checkLevelCompletion(); // Kontrollera om niv√•n √§r klar
                        } else if (activeColorNumber !== null) {
                            // Fel f√§rg feedback
                            cell.style.transition = 'none';
                            cell.style.backgroundColor = '#FF4500'; // R√∂d-orange som felindikation
                            setTimeout(() => {
                                cell.style.backgroundColor = '';
                                cell.style.transition = 'background-color 0.05s linear';
                            }, 150);
                        }
                    });
                    drawingAreaEl.appendChild(cell);
                }
            }
        }

        // Funktion f√∂r att ladda en specifik niv√•
        function loadLevel(index) {
            if (index >= 0 && index < levels.length) {
                currentLevelIndex = index;
                const level = levels[currentLevelIndex];
                
                levelIndicatorEl.textContent = `Niv√• ${currentLevelIndex + 1}`; // D√∂ljer bildnamnet
                levelCompletionMessageEl.textContent = ""; // Rensa meddelande

                createColorPalette(level.colors);
                createDrawingArea(level.pattern, level.rows, level.cols, level.cellSize);
                updateControlButtons();
            }
        }

        // Kontrollera om niv√•n √§r klar
        function checkLevelCompletion() {
            const cells = document.querySelectorAll('#drawing-area .cell');
            let allColored = true;
            for (const cell of cells) {
                // Bara rutor som har ett F√ñRV√ÑNTAT f√§rgv√§rde (inte 0) m√•ste f√§rgas
                if (parseInt(cell.dataset.expectedColor) !== 0 && !cell.classList.contains('colored')) {
                    allColored = false;
                    break;
                }
            }

            if (allColored) {
                levelCompletionMessageEl.textContent = `üéâ Grattis! Niv√• ${currentLevelIndex + 1} klar!`;
                
                // Om sista niv√•n √§r klar
                if (currentLevelIndex === levels.length - 1) {
                    levelCompletionMessageEl.textContent = `ü•≥ GRATTIS! Du har klarat alla TV-spelsbilder!`;
                    nextLevelBtn.disabled = true; // Ingen mer att g√• till
                }
            } else {
                levelCompletionMessageEl.textContent = ""; // Rensa meddelandet om man √•ngrar n√•got (inte relevant f√∂r nuvarande kod, men bra att ha)
            }
        }

        // Uppdatera knapparnas status (aktivera/inaktivera)
        function updateControlButtons() {
            prevLevelBtn.disabled = (currentLevelIndex === 0);
            nextLevelBtn.disabled = (currentLevelIndex === levels.length - 1);
        }

        // Eventlyssnare f√∂r niv√•navigering
        prevLevelBtn.addEventListener('click', () => {
            if (currentLevelIndex > 0) {
                loadLevel(currentLevelIndex - 1);
            }
        });

        nextLevelBtn.addEventListener('click', () => {
            if (currentLevelIndex < levels.length - 1) {
                loadLevel(currentLevelIndex + 1);
            }
        });

        // Starta med den f√∂rsta niv√•n
        loadLevel(0);
    </script>
</body>
</html>
