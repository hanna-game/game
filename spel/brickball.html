<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8" />
    <title>Super Mario Brick Breaker!</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(to bottom, #87CEEB, #6A5ACD); /* Bl친 himmel gradient */
            margin: 0;
            overflow: hidden;
            display: flex; /* Anv칛nd flexbox f칬r att centrera canvas */
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* S칛kerst칛ll att body fyller hela viewport-h칬jden */
        }
        canvas {
            display: block;
            /* Ta bort standard bakgrund, vi ritar den med JS */
            /* background: #222; */
            border: 5px solid #5A2C00; /* Tjock, brun "jord"-ram */
            border-radius: 10px; /* Rundade h칬rn p친 ramen */
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5); /* Liten skugga */
        }
    </style>
</head>
<body>
<canvas id="gameCanvas" width="640" height="480"></canvas> <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Boll (nu en gul Super Star)
    let x = canvas.width / 2;
    let y = canvas.height - 50; // Justera startposition
    let dx = 3; // 칐ka hastigheten lite
    let dy = -3; // 칐ka hastigheten lite
    const ballRadius = 12; // St칬rre boll

    // Paddle (Mario-r칬d)
    const paddleHeight = 15; // Tjockare paddel
    const paddleWidth = 100; // Bredare paddel
    let paddleX = (canvas.width - paddleWidth) / 2;

    // Tangenttryckning
    let rightPressed = false;
    let leftPressed = false;

    // Bricks (Mario-block)
    const brickRowCount = 5; // Fler rader
    const brickColumnCount = 8; // Fler kolumner
    const brickWidth = 65; // Justera storlek
    const brickHeight = 25; // Justera storlek
    const brickPadding = 8; // Mindre mellanrum
    const brickOffsetTop = 40; // Flytta ner lite
    const brickOffsetLeft = 35; // Flytta in lite

    const bricks = [];
    for (let c = 0; c < brickColumnCount; c++) {
        bricks[c] = [];
        for (let r = 0; r < brickRowCount; r++) {
            bricks[c][r] = { x: 0, y: 0, status: 1, hitCount: 0 }; // Lade till hitCount f칬r olika f칛rger
        }
    }

    let score = 0;
    let lives = 3; // Mario har liv!

    // Eventlyssnare
    document.addEventListener("keydown", keyDownHandler);
    document.addEventListener("keyup", keyUpHandler);
    document.addEventListener("mousemove", mouseMoveHandler); // F칬r muskontroll

    function keyDownHandler(e) {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = true;
        else if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = true;
    }

    function keyUpHandler(e) {
        if (e.key === "Right" || e.key === "ArrowRight") rightPressed = false;
        else if (e.key === "Left" || e.key === "ArrowLeft") leftPressed = false;
    }

    function mouseMoveHandler(e) {
        const relativeX = e.clientX - canvas.offsetLeft;
        if (relativeX > 0 && relativeX < canvas.width) {
            paddleX = relativeX - paddleWidth / 2;
        }
    }

    function collisionDetection() {
        for (let c = 0; c < brickColumnCount; c++) {
            for (let r = 0; r < brickRowCount; r++) {
                const b = bricks[c][r];
                if (b.status >= 1) { // Kontrollera om tegelstenen 칛r aktiv (kan ha flera HP)
                    if (
                        x > b.x &&
                        x < b.x + brickWidth &&
                        y > b.y &&
                        y < b.y + brickHeight
                    ) {
                        dy = -dy; // Byt riktning p친 bollen
                        b.hitCount++; // 칐ka tr칛ffr칛knaren

                        // Olika HP f칬r tegelstenar
                        if (b.status === 1) { // Standard tegelsten
                            b.status = 0;
                            score += 10; // Po칛ng f칬r att f칬rst칬ra block
                        } else if (b.status === 2 && b.hitCount >= 1) { // Starkare tegelsten
                             b.status = 0;
                             score += 20;
                        }
                        // Du kan l칛gga till fler "HP" niv친er f칬r tegelstenarna h칛r

                        if (score === brickRowCount * brickColumnCount * 10) { // Po칛ng f칬r att vinna baserat p친 nya po칛ngen
                            alert("游꿀 GRATTIS! DU VANN SUPER MARIO BRICK BREAKER!");
                            document.location.reload();
                        }
                    }
                }
            }
        }
    }

    // Rita himmel och moln som bakgrund p친 canvas
    function drawBackground() {
        // Bl친 himmel
        ctx.beginPath();
        ctx.rect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#87CEEB"; // Ljusbl친 himmel
        ctx.fill();
        ctx.closePath();

        // Enkel moln
        function drawCloud(cx, cy, scale = 1) {
            ctx.beginPath();
            ctx.arc(cx, cy, 20 * scale, 0, Math.PI * 2, true);
            ctx.arc(cx + 30 * scale, cy, 25 * scale, 0, Math.PI * 2, true);
            ctx.arc(cx + 50 * scale, cy + 10 * scale, 20 * scale, 0, Math.PI * 2, true);
            ctx.arc(cx + 20 * scale, cy + 15 * scale, 25 * scale, 0, Math.PI * 2, true);
            ctx.fillStyle = "#FFFFFF"; // Vit
            ctx.fill();
            ctx.closePath();
        }
        drawCloud(50, 50, 0.8);
        drawCloud(400, 100, 1.2);
        drawCloud(180, 20, 0.9);
        drawCloud(550, 300, 1.0);
    }

    // Rita bollen (Super Star)
    function drawBall() {
        ctx.beginPath();
        ctx.arc(x, y, ballRadius, 0, Math.PI * 2);
        ctx.fillStyle = "#FFD700"; // Guldgul f칛rg f칬r stj칛rnan
        ctx.shadowColor = "#FFD700"; // Gl칬d f칬r stj칛rnan
        ctx.shadowBlur = 10;
        ctx.fill();
        ctx.closePath();
        ctx.shadowBlur = 0; // 칀terst칛ll shadowblur
    }

    // Rita paddeln (Mario-r칬d)
    function drawPaddle() {
        ctx.beginPath();
        ctx.rect(paddleX, canvas.height - paddleHeight - 10, paddleWidth, paddleHeight); // Flytta upp paddeln lite fr친n botten
        ctx.fillStyle = "#FF0000"; // Stark r칬d
        ctx.strokeStyle = "#8B0000"; // M칬rk r칬d kant
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.fill();
        ctx.closePath();
    }

    // Rita tegelstenarna (Mario-block)
    function drawBricks() {
        for (let c = 0; c < brickColumnCount; c++) {
            for (let r = 0; r < brickRowCount; r++) {
                if (bricks[c][r].status >= 1) {
                    const brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
                    const brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
                    bricks[c][r].x = brickX;
                    bricks[c][r].y = brickY;
                    ctx.beginPath();
                    ctx.rect(brickX, brickY, brickWidth, brickHeight);

                    // F칛rg baserat p친 "HP" eller tr칛ffr칛knare (mer skadade = annan f칛rg)
                    if (bricks[c][r
